{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Configuración - SIEER Chile</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <link rel="stylesheet" href="{% static 'css/admin_panel.css' %}">
  
  <style>
    /* ======================================= */
    /* ¡CSS ESTÉTICO PARA CONFIGURACIÓN!       */
    /* ======================================= */

    /* 1. Variables de Estilo (Consistentes) */
    :root {
        --ms-panel: rgba(25, 25, 35, 0.9);
        --ms-border: 1px solid rgba(0, 255, 136, 0.3);
        --ms-accent: #00ffaa;
        --neon-glow: 0 0 20px rgba(0, 255, 136, 0.5);
        --ms-text: #ffffff;
        --ms-muted: #b0b0b0;
        --danger-color: #ff4757;
        --danger-border: 1px solid rgba(255, 71, 87, 0.4);
        --danger-glow: 0 0 20px rgba(255, 71, 87, 0.3);
    }

    /* 2. Layout en Grid (Más organizado) */
    .admin-content {
        display: grid;
        grid-template-columns: 2fr 1fr; /* Columna principal más ancha */
        gap: 2rem;
    }

    /* 3. Tarjeta de Configuración (Estilo Neón) */
    .config-card {
        background: var(--ms-panel);
        border: var(--ms-border);
        border-radius: 16px;
        padding: 2rem;
        box-shadow: var(--neon-glow);
        height: fit-content; /* Para que se ajuste al contenido */
    }

    .config-card h2 {
        color: var(--ms-accent);
        margin-top: 0;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: var(--ms-border);
        font-family: 'Montserrat', sans-serif;
    }

    /* 4. Estilos de Formulario (Como en Inventario) */
    .config-form {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Dos columnas para el form principal */
        gap: 1.5rem;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-group.full-width {
        grid-column: 1 / -1; /* Ocupa todo el ancho */
    }

    .form-group label {
        color: var(--ms-text);
        font-weight: 500;
        font-size: 0.9rem;
    }

    .form-group input,
    .form-group select {
        padding: 0.75rem;
        border: 1px solid rgba(0, 255, 136, 0.2);
        border-radius: 12px;
        background: #121a26;
        color: var(--ms-text);
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .form-group input:focus,
    .form-group select:focus {
        outline: none;
        border-color: var(--ms-accent);
        box-shadow: 0 0 0 2px rgba(41, 255, 154, 0.3);
    }

    /* 5. ¡NUEVO! Interruptor (Toggle Switch) Estético */
    .switch-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: #121a26;
        border-radius: 12px;
        border: 1px solid rgba(0, 255, 136, 0.2);
    }
    
    .switch-label {
        color: var(--ms-text);
        font-weight: 500;
        margin: 0;
    }

    .toggle-checkbox {
        display: none; /* Oculta el checkbox feo */
    }

    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 44px; /* Ancho del interruptor */
        height: 24px; /* Alto del interruptor */
        background-color: #334155;
        border-radius: 34px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    /* El círculo (thumb) */
    .toggle-switch::after {
        content: '';
        position: absolute;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background-color: white;
        top: 3px;
        left: 4px;
        transition: transform 0.3s ease;
    }

    /* Estado "Encendido" */
    .toggle-checkbox:checked + .toggle-switch {
        background-color: var(--ms-accent);
    }

    .toggle-checkbox:checked + .toggle-switch::after {
        transform: translateX(20px); /* Mueve el círculo */
    }

    /* 6. Zona de Peligro (Restablecer) */
    .danger-zone {
        border: var(--danger-border);
        box-shadow: var(--danger-glow);
    }
    .danger-zone h2 {
        color: var(--danger-color);
        border-bottom: var(--danger-border);
    }
    .danger-zone p {
        color: var(--ms-muted);
        font-size: 0.9rem;
        line-height: 1.5;
    }
    
    /* Botón de peligro */
    .btn-danger-outline {
        background: transparent;
        border: 1px solid var(--danger-color);
        color: var(--danger-color);
    }
    .btn-danger-outline:hover {
        background: rgba(255, 71, 87, 0.1);
        color: #ff8f8f;
        box-shadow: 0 0 10px rgba(255, 71, 87, 0.3);
    }

    /* 7. Contenedor de Acciones (Botones) */
    .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: var(--ms-border);
    }

    /* 8. Media Query para pantallas pequeñas */
    @media (max-width: 992px) {
        .admin-content {
            grid-template-columns: 1fr; /* Apila las columnas */
        }
        .config-form {
            grid-template-columns: 1fr; /* Apila los campos del formulario */
        }
    }
  </style>
</head>
<body>
<div class="admin-container">

  <aside class="admin-sidebar">
    <div class="sidebar-header">
      <div class="admin-logo">
        <img src="{% static 'img/logo.png' %}" alt="SIEER Chile Logo">
        <div class="logo-text"><h2>SIEER Chile</h2><span>Panel Administrativo</span></div>
      </div>
    </div>
    <nav class="sidebar-nav">
      <div class="nav-section">
        <h3>Facturación</h3>
        <ul>
                      <li class="nav-item {% if request.resolver_match.url_name == 'admin_panel' %}active{% endif %}">
                            <a href="{% url 'admin_panel' %}">
                                <i class="fas fa-tachometer-alt"></i> <!-- Ícono cambiado -->
                                <span>Dashboard</span> <!-- Texto cambiado -->
                            </a>
                        </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'calculos_estadisticas' %}active{% endif %}">
            <a href="{% url 'calculos_estadisticas' %}"><i class="fas fa-calculator"></i><span>Cálculos y Estadísticas</span></a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'cotizaciones' %}active{% endif %}">
            <a href="{% url 'cotizaciones' %}"><i class="fas fa-file-alt"></i><span>Cotizaciones</span></a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'control_inventario' %}active{% endif %}">
            <a href="{% url 'control_inventario' %}"><i class="fas fa-boxes"></i><span>Control de Inventario</span></a>
          </li>
        </ul>
      </div>
      <div class="nav-section">
        <h3>Reportes</h3>
        <ul>
          <li class="nav-item {% if request.resolver_match.url_name == 'reportes_graficos' %}active{% endif %}">
            <a href="{% url 'reportes_graficos' %}"><i class="fas fa-chart-bar"></i><span>Reportes Gráficos</span></a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'historial_cotizaciones' %}active{% endif %}">
              <a href="{% url 'historial_cotizaciones' %}"><i class="fas fa-history"></i><span>Historial de Cotizaciones</span></a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'cuenta' %}active{% endif %}">
            <a href="{% url 'cuenta' %}"><i class="fas fa-user-cog"></i><span>Cuenta</span></a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'configuracion' %}active{% endif %}">
            <a href="{% url 'configuracion' %}"><i class="fas fa-cogs"></i><span>Configuración</span></a>
          </li>
        </ul>
      </div>
    </nav>
    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar"><i class="fas fa-user-shield"></i></div>
        <div class="user-details"><strong>Administrador</strong><span>{{ user.username }}</span></div>
      </div>
      <form method="post" action="{% url 'logout' %}" class="logout-form">
        {% csrf_token %}
        <button type="submit" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</button>
      </form>
    </div>
  </aside>

  <main class="admin-main">
    <header class="admin-header">
      <div class="header-left">
        <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
        <h1>Configuración</h1>
      </div>
      <div class="header-right">
        <a class="btn btn-primary" href="{% url 'admin_panel' %}">
          <i class="fas fa-arrow-left"></i> Volver al Panel
        </a>
      </div>
    </header>

    <div class="admin-content">

      <div class="config-card">
        <h2>Información del Sistema</h2>
        <form method="post" class="config-form">
          {% csrf_token %}
          
          <div class="form-group">
            <label for="system_name">Nombre del sistema</label>
            <input type="text" id="system_name" name="system_name" value="{{ config.system_name|default:'SIEER Chile' }}">
          </div>
          
          <div class="form-group">
            <label for="email">Correo de contacto</label>
            <input type="email" id="email" name="email" value="{{ config.email|default:'contacto@sieer.cl' }}">
          </div>

          <div class="form-group full-width">
            <label for="telefono">Teléfono</label>
            <input type="tel" id="telefono" name="telefono" value="{{ config.telefono|default:'+56 9 8152 0994' }}">
          </div>
          
          <div class="form-actions full-width">
            <button class="btn btn-primary" type="submit">
              <i class="fas fa-save"></i> Guardar cambios
            </button>
          </div>
        </form>
      </div>

        <div class="config-card danger-zone">
          <h2>Restablecer Sistema</h2>
          <p>Esta acción eliminará configuraciones personalizadas y restablecerá los valores predeterminados. Úsala con precaución.</p>
          <div class="form-actions">
            <button class="btn btn-danger-outline">
              <i class="fas fa-undo"></i> Restablecer valores
            </button>
          </div>
        </div>

      </div>
    </div>
  </main>
</div>

<script src="{% static 'js/admin_panel.js' %}"></script>
</body>
</html>